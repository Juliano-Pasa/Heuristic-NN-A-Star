import sys
import os
import pandas as pd
import datetime
import shutil
import time
import io
import glob
import matplotlib.pyplot as plt
from   sklearn.model_selection       import train_test_split

import tensorflow                    as     tf
from   tensorflow                    import keras
from   tensorflow.keras              import losses
from   tensorflow.keras              import metrics
from   tensorflow.keras.callbacks    import Callback, CSVLogger, EarlyStopping, ModelCheckpoint, TensorBoard
from   tensorflow.keras.initializers import GlorotNormal, GlorotUniform, HeNormal
from   tensorflow.keras.layers       import Dense, Dropout, Input
from   tensorflow.keras.models       import load_model, Sequential
from   tensorflow.keras.optimizers   import Adam

def main():
    
    csvfile = open("OUT_MAPE_NOVP.csv")
    
    loss = [0.8291252255439758, 0.6016815900802612, 0.5594732165336609, 0.5310319662094116, 0.4949546158313751, 0.45025911927223206, 0.4197651147842407, 0.40049394965171814, 0.3848247826099396, 0.37306615710258484, 0.36373791098594666, 0.35575440526008606, 0.34906360507011414, 0.34272781014442444, 0.3368750810623169, 0.332467645406723, 0.3277258574962616, 0.32391294836997986, 0.32044747471809387, 0.31757089495658875, 0.31511521339416504, 0.3124914765357971, 0.31025850772857666, 0.308346688747406, 0.30576714873313904, 0.3037951588630676, 0.30194684863090515, 0.3003721535205841, 0.29893457889556885, 0.2974066138267517, 0.2956019341945648, 0.29433685541152954, 0.2922816574573517, 0.2906937003135681, 0.2891783118247986, 0.28781211376190186, 0.28667595982551575, 0.28539854288101196, 0.28365424275398254, 0.28273922204971313, 0.28140705823898315, 0.2801314890384674, 0.27889493107795715, 0.27776437997817993, 0.2771562337875366, 0.2761083245277405, 0.2750301957130432, 0.2743232548236847, 0.27321043610572815, 0.27208060026168823, 0.27126628160476685, 0.27059635519981384, 0.26979610323905945, 0.2690887153148651, 0.26810526847839355, 0.26756349205970764, 0.26674631237983704, 0.2659968137741089, 0.26532915234565735, 0.26479825377464294, 0.26437970995903015, 0.26362326741218567, 0.26262521743774414, 0.2625494599342346, 0.2616347074508667, 0.26109713315963745, 0.2604875862598419, 0.25996264815330505, 0.25970879197120667, 0.2590135335922241, 0.25830695033073425, 0.25790852308273315, 0.2574910819530487, 0.25671908259391785, 0.2562137544155121, 0.2559139132499695, 0.25574925541877747, 0.2551530599594116, 0.2544858455657959, 0.25427573919296265, 0.2537717819213867, 0.2529487609863281, 0.2525136470794678, 0.25216004252433777, 0.25189006328582764, 0.25141996145248413, 0.2508406937122345, 0.2506277561187744, 0.2503238916397095, 0.24945135414600372, 0.2491832673549652, 0.24879896640777588, 0.24875758588314056, 0.24838224053382874, 0.24788635969161987, 0.24763727188110352, 0.2473011314868927, 0.24649672210216522, 0.24631261825561523, 0.2460215538740158]
    mean_absolute_percentage_error = [0.8291252255439758, 0.6016815900802612, 0.5594732165336609, 0.5310319662094116, 0.4949546158313751, 0.45025911927223206, 0.4197651147842407, 0.40049394965171814, 0.3848247826099396, 0.37306615710258484, 0.36373791098594666, 0.35575440526008606, 0.34906360507011414, 0.34272781014442444, 0.3368750810623169, 0.332467645406723, 0.3277258574962616, 0.32391294836997986, 0.32044747471809387, 0.31757089495658875, 0.31511521339416504, 0.3124914765357971, 0.31025850772857666, 0.308346688747406, 0.30576714873313904, 0.3037951588630676, 0.30194684863090515, 0.3003721535205841, 0.29893457889556885, 0.2974066138267517, 0.2956019341945648, 0.29433685541152954, 0.2922816574573517, 0.2906937003135681, 0.2891783118247986, 0.28781211376190186, 0.28667595982551575, 0.28539854288101196, 0.28365424275398254, 0.28273922204971313, 0.28140705823898315, 0.2801314890384674, 0.27889493107795715, 0.27776437997817993, 0.2771562337875366, 0.2761083245277405, 0.2750301957130432, 0.2743232548236847, 0.27321043610572815, 0.27208060026168823, 0.27126628160476685, 0.27059635519981384, 0.26979610323905945, 0.2690887153148651, 0.26810526847839355, 0.26756349205970764, 0.26674631237983704, 0.2659968137741089, 0.26532915234565735, 0.26479825377464294, 0.26437970995903015, 0.26362326741218567, 0.26262521743774414, 0.2625494599342346, 0.2616347074508667, 0.26109713315963745, 0.2604875862598419, 0.25996264815330505, 0.25970879197120667, 0.2590135335922241, 0.25830695033073425, 0.25790852308273315, 0.2574910819530487, 0.25671908259391785, 0.2562137544155121, 0.2559139132499695, 0.25574925541877747, 0.2551530599594116, 0.2544858455657959, 0.25427573919296265, 0.2537717819213867, 0.2529487609863281, 0.2525136470794678, 0.25216004252433777, 0.25189006328582764, 0.25141996145248413, 0.2508406937122345, 0.2506277561187744, 0.2503238916397095, 0.24945135414600372, 0.2491832673549652, 0.24879896640777588, 0.24875758588314056, 0.24838224053382874, 0.24788635969161987, 0.24763727188110352, 0.2473011314868927, 0.24649672210216522, 0.24631261825561523, 0.2460215538740158]    #print(reader['loss'])
    val_loss = [0.6584265232086182, 0.5410544276237488, 0.528802216053009, 0.5471052527427673, 0.4775311350822449, 0.5248421430587769, 0.4716661870479584, 0.39675477147102356, 0.37064942717552185, 0.43834033608436584, 0.3394169807434082, 0.3522440195083618, 0.331169456243515, 0.33413341641426086, 0.3456132709980011, 0.31925415992736816, 0.34991198778152466, 0.3275182545185089, 0.442518025636673, 0.306624174118042, 0.30830422043800354, 0.2963315546512604, 0.28947582840919495, 0.29171621799468994, 0.29558029770851135, 0.28934645652770996, 0.29360413551330566, 0.2864115238189697, 0.30145499110221863, 0.2825582027435303, 0.3082374930381775, 0.2827501893043518, 0.28142791986465454, 0.31315767765045166, 0.2932792901992798, 0.27444714307785034, 0.29166439175605774, 0.27297428250312805, 0.2834680676460266, 0.27388739585876465, 0.2766188979148865, 0.26471757888793945, 0.2773106098175049, 0.2681998312473297, 0.2796998918056488, 0.2716560959815979, 0.2732657790184021, 0.2650972008705139, 0.29057416319847107, 0.2668800950050354, 0.26197367906570435, 0.2931583821773529, 0.2691555619239807, 0.26799657940864563, 0.31045448780059814, 0.2600451111793518, 0.25642532110214233, 0.2597019672393799, 0.26434454321861267, 0.25235897302627563, 0.27890390157699585, 0.2596246898174286, 0.27897530794143677, 0.2562062442302704, 0.2608311176300049, 0.26543524861335754, 0.28766679763793945, 0.26813143491744995, 0.2674194872379303, 0.2444179356098175, 0.24844709038734436, 0.25005611777305603, 0.2694672644138336, 0.2570165693759918, 0.260648638010025, 0.31847667694091797, 0.25417327880859375, 0.25184160470962524, 0.2713833451271057, 0.25590166449546814, 0.2558455169200897, 0.24982193112373352, 0.24934840202331543, 0.24533259868621826, 0.23838628828525543, 0.23989194631576538, 0.24246744811534882, 0.25113141536712646, 0.249063640832901, 0.28696489334106445, 0.24217009544372559, 0.2445993423461914, 0.251181960105896, 0.24578799307346344, 0.24348995089530945, 0.2501809597015381, 0.22890575230121613, 0.258884459733963, 0.2584191858768463, 0.23369000852108002]    # Plotando acerto
    val_mean_absolute_percentage_error = [0.6584265232086182, 0.5410544276237488, 0.528802216053009, 0.5471052527427673, 0.4775311350822449, 0.5248421430587769, 0.4716661870479584, 0.39675477147102356, 0.37064942717552185, 0.43834033608436584, 0.3394169807434082, 0.3522440195083618, 0.331169456243515, 0.33413341641426086, 0.3456132709980011, 0.31925415992736816, 0.34991198778152466, 0.3275182545185089, 0.442518025636673, 0.306624174118042, 0.30830422043800354, 0.2963315546512604, 0.28947582840919495, 0.29171621799468994, 0.29558029770851135, 0.28934645652770996, 0.29360413551330566, 0.2864115238189697, 0.30145499110221863, 0.2825582027435303, 0.3082374930381775, 0.2827501893043518, 0.28142791986465454, 0.31315767765045166, 0.2932792901992798, 0.27444714307785034, 0.29166439175605774, 0.27297428250312805, 0.2834680676460266, 0.27388739585876465, 0.2766188979148865, 0.26471757888793945, 0.2773106098175049, 0.2681998312473297, 0.2796998918056488, 0.2716560959815979, 0.2732657790184021, 0.2650972008705139, 0.29057416319847107, 0.2668800950050354, 0.26197367906570435, 0.2931583821773529, 0.2691555619239807, 0.26799657940864563, 0.31045448780059814, 0.2600451111793518, 0.25642532110214233, 0.2597019672393799, 0.26434454321861267, 0.25235897302627563, 0.27890390157699585, 0.2596246898174286, 0.27897530794143677, 0.2562062442302704, 0.2608311176300049, 0.26543524861335754, 0.28766679763793945, 0.26813143491744995, 0.2674194872379303, 0.2444179356098175, 0.24844709038734436, 0.25005611777305603, 0.2694672644138336, 0.2570165693759918, 0.260648638010025, 0.31847667694091797, 0.25417327880859375, 0.25184160470962524, 0.2713833451271057, 0.25590166449546814, 0.2558455169200897, 0.24982193112373352, 0.24934840202331543, 0.24533259868621826, 0.23838628828525543, 0.23989194631576538, 0.24246744811534882, 0.25113141536712646, 0.249063640832901, 0.28696489334106445, 0.24217009544372559, 0.2445993423461914, 0.251181960105896, 0.24578799307346344, 0.24348995089530945, 0.2501809597015381, 0.22890575230121613, 0.258884459733963, 0.2584191858768463, 0.23369000852108002]
    
    # Plotando MAPE
    plt.plot(mean_absolute_percentage_error)
    plt.plot(val_mean_absolute_percentage_error)    
    plt.title("Mean absolute percentage error of the Model")
    plt.ylabel("Mean absolute percentage error")
    plt.xlabel("Epoch")
    plt.legend(["Train", "Val"], loc='upper left')
    plt.show()
    
    # Plotando perda
    plt.plot(loss)
    plt.plot(val_loss)
    plt.title("Loss of the Model")
    plt.ylabel("Loss")
    plt.xlabel("Epoch")
    plt.legend(["Train", "Val"], loc='upper left')
    plt.show()
    
    
if __name__ == '__main__':
    main()
